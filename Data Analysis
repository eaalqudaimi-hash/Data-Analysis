import pandas as pd
import matplotlib.pyplot as plt
from datetime import datetime
import numpy as np

# -------- إنشاء بيانات وهمية لمنظمة غير ربحية مع 5000 سجل -------- #
np.random.seed(42)
num_records = 5000  # عدد كبير من السجلات
dates = pd.date_range(start="2022-01-01", periods=num_records, freq='D')  # يوميًا
assistance_types = np.random.choice(['Medical', 'Food', 'Education', 'Shelter'], size=num_records)
beneficiaries = np.random.randint(5, 500, size=num_records)
cities = np.random.choice(['Riyadh', 'Jeddah', 'Dammam', 'Mecca', 'Medina'], size=num_records)

df = pd.DataFrame({
    'campaign_date': dates,
    'assistance_type': assistance_types,
    'beneficiaries': beneficiaries,
    'city': cities
})

# حفظ البيانات في ملف CSV
df.to_csv("ngo_campaign_data_5000.csv", index=False)

# -------- تحليل البيانات -------- #
print("Analysis run at:", datetime.now().strftime("%Y-%m-%d %H:%M:%S"))

df['campaign_date'] = pd.to_datetime(df['campaign_date'])
df['month'] = df['campaign_date'].dt.to_period('M')

# إجمالي المستفيدين لكل نوع مساعدة شهريًا
monthly_beneficiaries = df.groupby(['month', 'assistance_type'])['beneficiaries'].sum().unstack()

# رسم بياني
monthly_beneficiaries.plot(kind='bar', stacked=True, figsize=(16,8), title='Monthly Beneficiaries by Assistance Type')
plt.xlabel('Month')
plt.ylabel('Number of Beneficiaries')
plt.tight_layout()
plt.savefig('monthly_beneficiaries_5000.png')
plt.show()
